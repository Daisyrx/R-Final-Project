---
title: "Final Project"
author: "Runxin Yu"
date: "12/16/2019"
output: ioslides_presentation
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
pacman::p_load(tidyverse,readr,knitr,ggplot2,magrittr,dplyr,plotly,tidytext,wordcloud)
```

```{r echo = FALSE}
crime <- read.csv("Crime Incident.csv")
colnames(crime) <- c("Incident_Number","Offence_Code","Offence_Code_Group","Description","District","Area",
                     "Shooting","Occurred_Date","Year","Month","Day_of_Week","Hour","UCR_Part","Street","Latitude",
                     "Longtitude","Location")
crime <- crime[-c(1:7),]
crime %<>% na.omit()
crime %<>% mutate(City = District)
crime$City <- as.character(crime$City)
crime$City[crime$City == "E18"] <- "Hyde Park"
crime$City[crime$City == "D14"] <- "Brighton"
crime$City[crime$City == "D4"] <- "South End"
crime$City[crime$City == "A15"] <- "Charlestown"
crime$City[crime$City == "B3"] <- "Mattapan"
crime$City[crime$City == "A7"] <- "East Boston"
crime$City[crime$City == "A1"] <- "Downtown"
crime$City[crime$City == "E5"] <- "West Roxbury"
crime$City[crime$City == "B2"] <- "Roxbury"
crime$City[crime$City == "C11"] <- "Dorchester"
crime$City[crime$City == "C6"] <- "South Boston"
crime$City[crime$City == "E13"] <- "Jamaica Plain"
crime$City[crime$City == ""] <- NA
crime %<>% na.omit()
crime %<>% filter(Offence_Code_Group != "Aircraft")
```

## Summary for Offence Type

Since there are more than 60 offence types, just take a look at how many incidents happened for the first 10 offence type:
```{r pressure}
head(summary(crime$Offence_Code_Group),10)
```

## Summary for Cities

Take a look at how many incidents happened for each city:
```{r echo=FALSE}
summary(as.factor(crime$City))
```
City has the most incidents happened:
```{r echo=FALSE}
paste("Roxbury:",summary(as.factor(crime$City)) %>% max())
```
City has the least incidents happened:
```{r echo=FALSE}
paste("Charlestown:",summary(as.factor(crime$City)) %>% min())
```

## City Visualization

Does the number of incidents varies significantly by cities?
```{r echo=FALSE}
plotly_build(ggplot(crime)+
  geom_bar(aes(x = City,fill = factor(Year)),stat = "count",position = "dodge")+
  coord_flip()+ theme(legend.title = element_blank())) 
```

## City Visualization -- Continue

Proportion
```{r echo=FALSE}
crime$Year <- factor(crime$Year,levels = c("2015","2016","2017","2018","2019"))
ggplot(crime) + 
  geom_bar(aes(x = City, y = ..prop..,group=1)) + 
  facet_wrap(~ Year, nrow = 2)+
  theme(axis.text.x = element_text(angle = 75))
```

## City -- Findings

Generally speaking, there were some differences in the number of incidents happened between cities. Both plots shows that Roxbury and Dorchester have the largest number of incidents occurred during the past few years. Carlestown, Hyde Park and East Boston have relatively the least number of incidents occurred during the past few years. More generally, south part of Boston area tend to have more incidents happened than north part of Boston area.

## Year Visualization

Does the number of incidents varies significantly by years?
```{r echo=FALSE}
plotly_build(ggplot(crime)+
  geom_bar(aes(x = Year,fill = factor(City)),stat = "count",position = "dodge")+
  coord_flip()+ theme(legend.title = element_blank())) 
```

## Year Visualization -- Continue

Proportion
```{r echo=FALSE}
ggplot(crime) + 
  geom_bar(aes(x = Year,y = ..prop..,group = 1)) + 
  facet_wrap(~ City, nrow = 4) +
  theme(axis.text.x = element_text(angle = 35))
```

## Year -- Findings

Initially, I believe that there should be a difference in the number of accidents happened vary from years. However, from both plots above, there are no clear differences in number of incidents occurred between different years. There were relatively fewer incidents occurred in the year 2015 and the number of incidents tends to be similar from year 2016 till 2018. The number dropped a little bit this year in 2019. 

## Text Mining

The word most frequently appeared in incident description is `property`
```{r echo=FALSE, warning = FALSE,message=FALSE}
set.seed(2019)
crime$Description <- tolower(crime$Description)
test <- tibble(line = 1:length(crime$Description),text = crime$Description)
word <- test %>% unnest_tokens(word,text)
word %>%
  anti_join(stop_words) %>%
  count(word) %>%
  with(wordcloud(word, n, max.words = 100))
```





